{
  "hash": "d92d71bd07e6906f44ef8e2f98eb32e3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Map\"\nformat: html\nmessage: false\nwarning: false\n---\n\n\n\n\nHere's the code for the map construction.\n\n# Packages\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggthemes)\nlibrary(ggrepel)\nlibrary(ggspatial)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthhires)\nlibrary(dplyr)\nlibrary(readxl)\n```\n:::\n\n\n\n\n# Geographic data\n\nWe’re going to upload the trial location data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Geographic data\nBRA <- ne_states(country = \"Brazil\", returnclass = \"sf\")\n\n# Import data\nlat_lon <- read_excel(\"lat_lon.xlsx\")\nlat_lon$lat <- as.numeric(lat_lon$lat)\nlat_lon$lon <- as.numeric(lat_lon$lon)\n\n# Define map boundaries based on coordinates\nlong_min <- min(lat_lon$lon, na.rm = TRUE) - 2.5\nlong_max <- max(lat_lon$lon, na.rm = TRUE) + 2.5\nlat_min <- min(lat_lon$lat, na.rm = TRUE) - 2.5\nlat_max <- max(lat_lon$lat, na.rm = TRUE) + 2.5\n\n# Highlight selected states\nhighlighted_states <- c(\"SP\", \"PR\", \"GO\", \"DF\")\nBRA$highlight <- ifelse(BRA$postal %in% highlighted_states, \"Highlighted\", \"Normal\")\n\n# Label adjustments\nnudge_x_vals <- ifelse(lat_lon$local == \"Assis Chateaubriand\", -0.7, 0.5)\nnudge_y_vals <- ifelse(lat_lon$local == \"Assis Chateaubriand\", -1, 0.7)\n```\n:::\n\n\n\n\n# Build the map\n\nHere, we’re going to build the map using the `ggplot2` package.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Build the map\nmain_map <- ggplot(BRA) +\n  geom_sf(aes(fill = highlight), alpha = 0.5, color = \"black\") +\n  scale_fill_manual(values = c(\"Highlighted\" = \"grey70\", \"Normal\" = \"white\"), guide = \"none\") +\n  geom_point(data = lat_lon, aes(lon, lat, size = total_n), alpha = 0.8, color = \"grey20\") +\n  coord_sf(xlim = c(long_min, long_max), ylim = c(lat_min, lat_max), expand = FALSE) +\n  geom_label_repel(data = lat_lon,\n                   aes(lon, lat, label = local),\n                   size = 3,\n                   nudge_x = nudge_x_vals,\n                   nudge_y = nudge_y_vals,\n                   fill = \"white\", color = \"black\") +\n  scale_size_continuous(range = c(1, 8), guide = guide_legend(title = \"Number of Trials\")) +\n  labs(x = \"Longitude\", y = \"Latitude\") +\n  theme_bw() +\n  theme(legend.position = \"right\", text = element_text(size = 8)) +\n  annotation_scale(location = \"bl\", width_hint = 0.3) +\n  annotation_north_arrow(location = \"tl\", which_north = \"true\",\n                         style = north_arrow_fancy_orienteering()) +\n  annotate(\"text\", x = -55, y = -15.5, label = \"MT\", size = 3, color = \"black\") +\n  annotate(\"text\", x = -49.5, y = -15.5, label = \"GO\", size = 3, color = \"black\") +\n  annotate(\"text\", x = -54.6, y = -20, label = \"MS\", size = 3, color = \"black\") +\n  annotate(\"text\", x = -51.2, y = -24, label = \"PR\", size = 3, color = \"black\") +\n  annotate(\"text\", x = -54.5, y = -29, label = \"RS\", size = 3, color = \"black\") +\n  annotate(\"text\", x = -50, y = -21.5, label = \"SP\", size = 3, color = \"black\") +\n  annotate(\"text\", x = -50.5, y = -27.4, label = \"SC\", size = 3, color = \"black\") +\n  annotate(\"text\", x = -45.5, y = -18.5, label = \"MG\", size = 3, color = \"black\")\n```\n:::\n\n\n\n\n# Map visualization\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmain_map\n```\n\n::: {.cell-output-display}\n![](Map_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Map_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}